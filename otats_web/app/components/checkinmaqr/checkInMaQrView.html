<link href="/app/components/checkinmaqr/checkInMaQrStyle.css" rel="stylesheet" />
<script src="/Scripts/html5-qrcode.min.js"></script>
<style>
    .qr-container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        text-align: center;
    }

    #reader {
        width: 100%;
        margin-bottom: 20px;
    }

    .result-container {
        margin-top: 20px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
        text-align: left;
    }

    .result-item {
        margin-bottom: 10px;
        font-size: 16px;
    }

    .result-label {
        font-weight: bold;
        margin-right: 5px;
    }

    .status-active {
        color: green;
        font-weight: bold;
    }

    .status-inactive {
        color: red;
        font-weight: bold;
    }

    .input-manual {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        font-size: 16px;
    }

    .btn-scan {
        margin-bottom: 10px;
    }
</style>

<div class="container-fluid">
    <div class="body-dashboard">
        <div class="body-box">
            <div class="qr-container">
                <h2 class="text-info">Check-in QR Code</h2>

                <!-- Input for Scanner Device / Manual Entry -->
                <input type="text" id="manualInput" class="form-control input-manual" ng-model="manualCode"
                    ng-keypress="handleManualInput($event)" placeholder="Quét mã hoặc nhập mã vé..." autofocus>

                <!-- Button to toggle Camera (Mobile) -->
                <button class="btn btn-primary btn-scan" ng-click="toggleCamera()">
                    <i class="fas fa-camera"></i> {{ isCameraOpen ? 'Đóng Camera' : 'Mở Camera (Mobile)' }}
                </button>

                <!-- Camera Viewfinder -->
                <div id="reader" ng-show="isCameraOpen"></div>

                <!-- Result Display -->
                <div class="result-container" ng-if="ticketResult">
                    <div class="result-item">
                        <span class="result-label">Trạng thái:</span>
                        <span
                            ng-class="{'status-active': ticketResult.status === 'Chưa sử dụng', 'status-inactive': ticketResult.status !== 'Chưa sử dụng'}">
                            {{ ticketResult.status }}
                        </span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Code/Mã vé:</span>
                        <span>{{ ticketResult.code }}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Booking/Mã đặt chỗ:</span>
                        <span>{{ ticketResult.bookingCode }}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">InvoiceCode/Số bill:</span>
                        <span>{{ ticketResult.invoiceCode }}</span>
                    </div>
                </div>
                <div class="result-container" ng-if="errorMessage">
                    <div class="result-item text-danger">
                        {{ errorMessage }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>